!function(i){var t;window.UIkit&&(t=i(UIkit)),"function"==typeof define&&define.amd&&define("uikit-lightbox",["uikit"],function(){return t||i(UIkit)})}(function(i){"use strict";function t(t){return e?(e.lightbox=t,e):(e=i.$(['<div class="uk-modal">','<div class="uk-modal-dialog uk-modal-dialog-lightbox uk-slidenav-position" style="margin-left:auto;margin-right:auto;width:200px;height:200px;top:'+Math.abs(window.innerHeight/2-200)+'px;">','<a href="#" class="uk-modal-close uk-close uk-close-alt"></a>','<div class="uk-grid uk-margin-remove">','<div class="uk-lightbox-content uk-padding-remove uk-width-6-10"></div>','<div class="uk-lightbox-related uk-width-1-10 uk-margin-remove uk-padding-remove"></div>',"</div>",'<div class="uk-modal-spinner uk-hidden"></div>',"</div>","</div>"].join("")).appendTo("body"),e.dialog=e.find(".uk-modal-dialog:first"),e.content=e.find(".uk-lightbox-content:first"),e.related=e.find(".uk-lightbox-related:first"),e.loader=e.find(".uk-modal-spinner:first"),e.closer=e.find(".uk-close.uk-close-alt"),e.modal=i.modal(e,{modal:!1}),e.on("swipeRight swipeLeft",function(i){e.lightbox["swipeLeft"==i.type?"next":"previous"]()}).on("click","[data-lightbox-previous], [data-lightbox-next]",function(t){t.preventDefault(),e.lightbox[i.$(this).is("[data-lightbox-next]")?"next":"previous"]()}),e.on("click",".sibling",function(i){i.preventDefault(),e.lightbox.show_sibling($(this).data("sibling-index"))}),e.on("hide.uk.modal",function(i){e.content.html(""),e.related.html("")}),i.$win.on("load resize orientationchange",i.Utils.debounce(function(t){e.is(":visible")&&!i.Utils.isFullscreen()&&e.lightbox.fitSize();UIkit.grid(i.$("#related_grid"),{gutter:5})}.bind(this),100)),e.lightbox=t,e)}var e,a={};return i.component("lightbox",{defaults:{group:!1,duration:400,keyboard:!0},index:0,items:!1,boot:function(){i.$html.on("click","[data-uk-lightbox]",function(t){t.preventDefault();var e=i.$(this);e.data("lightbox")||i.lightbox(e,i.Utils.options(e.attr("data-uk-lightbox"))),e.data("lightbox").show(e)}),i.$doc.on("keyup",function(i){if(e&&e.is(":visible")&&e.lightbox.options.keyboard)switch(i.preventDefault(),i.keyCode){case 37:e.lightbox.previous();break;case 39:e.lightbox.next()}})},init:function(){var t=[];if(this.index=0,this.siblings=[],this.element&&this.element.length){var e=this.options.group?i.$(['[data-uk-lightbox*="'+this.options.group+'"]',"[data-uk-lightbox*='"+this.options.group+"']"].join(",")):this.element;e.each(function(e){var a=i.$(this);t.push({source:a.attr("data-lightbox-href"),thumb:a.attr("data-lightbox-thumb"),header:a.attr("data-lightbox-header"),footer:a.attr("data-lightbox-footer"),cat_slug:a.attr("data-category"),cat_name:a.attr("data-category-name"),date:a.attr("data-date"),type:a.attr("data-lightbox-type")||"auto",link:a,sblng_index:e})}),this.index=e.index(this.element),this.siblings=t}else this.options.group&&this.options.group.length&&(this.siblings=this.options.group);this.trigger("lightbox-init",[this])},show:function(e){var a=i.Utils.options(this.element.attr("data-uk-lightbox"));if(a.group!=this.options.group){var o=[];this.index=0,this.siblings=[],this.options.group=a.group;var d=this.options.group?i.$(['[data-uk-lightbox*="'+this.options.group+'"]',"[data-uk-lightbox*='"+this.options.group+"']"].join(",")):this.element;d.each(function(t){var e=i.$(this);o.push({source:e.attr("data-lightbox-href"),thumb:e.attr("data-lightbox-thumb"),header:e.attr("data-lightbox-header"),footer:e.attr("data-lightbox-footer"),cat_slug:e.attr("data-category"),cat_name:e.attr("data-category-name"),visitlink:e.attr("data-lightbox-visitlink"),date:e.attr("data-date"),type:e.attr("data-lightbox-type")||"auto",link:e,sblng_index:t})}),this.index=d.index(this.element),this.siblings=o}this.modal=t(this),this.modal.dialog.stop(),this.modal.content.stop();var s,n,h=this,l=i.$.Deferred();e=e||0,"object"==typeof e&&this.siblings.forEach(function(i,t){e[0]===i.link[0]&&(e=t)}),0>e?e=this.siblings.length-e:this.siblings[e]||(e=0),n=this.siblings[e],s={lightbox:h,source:n.source,header:n.header,footer:n.footer,cat_slug:n.cat_slug,cat_name:n.cat_name,date:n.date,type:n.type,index:e,promise:l,item:n,meta:{content:"",hdr:"",ftr:"",related:"",width:"",height:"",r_width:"",r_height:""}};var r="",g="";if(s.header){var u=i.$("div[data-uk-filter="+s.cat_slug+"]").find(".gallery-social").html();r=' <div class="uk-modal-head uk-margin-remove">                        <div class="uk-modal-header uk-grid uk-margin-remove" style=""><div class="uk-width-large-7-10">'+s.header+'</div>                        <div class="uk-width-large-3-10 uk-padding-remove" >'+u+"</div></div>"}s.footer&&(g='<div class="uk-modal-footer">'+s.footer+"</div>"),s.meta.hdr=r,s.meta.ftr=g;var c='<div id="related_grid" class="uk-grid-width-1-2  uk-margin-remove" data-uk-grid >';this.siblings.forEach(function(i,t){c+='<div data-sibling-index="'+i.sblng_index+'" id="sblng_'+i.sblng_index+'" class="sibling"><img src="'+i.thumb+'"></div>'}),c+="</div>",s.meta.related=c,this.index=e,this.modal.content.empty(),this.modal.is(":visible")||(this.modal.content.css({width:"",height:""}).empty(),this.modal.related.css({r_width:"",r_height:""}).empty(),this.modal.modal.show()),this.modal.loader.removeClass("uk-hidden"),l.promise().done(function(){h.data=s,h.fitSize(h.data);var t=h.modal.dialog.find('#related_grid img[src!=""]');if(!t.length)return $.Deferred().resolve().promise();var e=[];t.each(function(){var i=$.Deferred();e.push(i);var t=new Image;t.onload=function(){i.resolve()},t.onerror=function(){i.resolve()},t.src=this.src}),$.when.apply($,e).then(function(){UIkit.grid(i.$("#related_grid"),{gutter:5});if(s.meta.maxwidth>738){var t,e=h.modal.dialog.find(".uk-modal-header").outerHeight(!0)?h.modal.dialog.find(".uk-modal-header").outerHeight(!0):0,a=h.modal.dialog.find(".image-footer").outerHeight(!0)?h.modal.dialog.find(".image-footer").outerHeight(!0):0,o=h.modal.dialog.find(".uk-modal-footer").outerHeight(!0)?h.modal.dialog.find(".uk-modal-footer").outerHeight(!0):0,d=h.modal.dialog.find(".uk-lightbox-related"),n=h.modal.dialog.find(".source").height();$("#related_grid").promise().done(function(){t=$("#related_grid").height(),d.height(n+e+a+o);var i=h.modal.dialog.find("#sub_grid"),s=h.modal.dialog.find(".scrollbar"),l=i.height(),r=i[0].scrollHeight,g=l*l/r;t>n+e+a+o&&(s.height(g).draggable({axis:"y",containment:"parent",drag:function(t,e){i.scrollTop(r/l*e.position.top)}}),i.on("scroll",function(){s.css({top:i.scrollTop()/l*g})})),h.modal.related.css("height","auto")})}})}).fail(function(){s.meta.content='<div class="uk-position-cover uk-flex uk-flex-middle uk-flex-center"><strong>Loading resource failed!</strong></div>',s.meta.width=400,s.meta.height=300,h.data=s,h.fitSize(s)}),h.trigger("showitem.uk.lightbox",[s])},fitSize:function(){var t=this,e=this.data,a=this.modal.dialog.outerWidth()-this.modal.dialog.width(),o=parseInt(this.modal.dialog.css("margin-top"),10),d=parseInt(this.modal.dialog.css("margin-bottom"),10),s=o+d,n=e.meta.content,h=e.meta.related,l=t.options.duration;this.siblings.length>1&&(n=[n,'<a href="#" class="uk-slidenav uk-slidenav-contrast uk-slidenav-previous uk-hidden-touch" data-lightbox-previous></a>','<a href="#" class="uk-slidenav uk-slidenav-contrast uk-slidenav-next uk-hidden-touch" data-lightbox-next></a>'].join(""));var r,g,u=i.$("<div>&nbsp;</div>").css({opacity:0,position:"absolute",top:0,left:0,width:"100%","max-width":t.modal.dialog.css("max-width"),padding:t.modal.dialog.css("padding"),margin:t.modal.dialog.css("margin")}),c=e.meta.width,m=e.meta.height,f=e.meta.r_width;u.appendTo("body").width(),r=u.width(),g=window.innerHeight-s,e.meta.maxwidth=r,738>=r?e.meta.r_width=r:e.meta.r_width=240,f=e.meta.r_width,u.remove(),this.modal.dialog.find(".uk-modal-caption").remove(),this.modal.dialog.find(".uk-modal-head").remove(),this.modal.dialog.find(".uk-modal-header").remove(),this.modal.dialog.find(".uk-related-header").remove(),this.modal.dialog.find(".uk-modal-footer").remove(),this.modal.dialog.find(".td.uk-button").remove(),this.modal.dialog.find(".scrollbar").remove(),r<e.meta.width&&(m=Math.floor(m*(r/c)),c=r),m>g&&(m=Math.floor(g),c=Math.ceil(e.meta.width*(g/e.meta.height))),this.modal.content.css("opacity",0).width(c).html(n),this.modal.dialog.find(".uk-modal-head").css("opacity",0),this.modal.related.width(f).html(h),this.modal.related.prepend('<div class="uk-related-header  uk-padding-remove"> Category: '+e.cat_name+"</div>"),this.modal.closer.addClass("uk-hidden"),t.modal.data("mwidth")==c&&t.modal.data("mheight")==m&&(l=0);var v=t.modal.dialog.find(".uk-lightbox-content").outerHeight(),b=Math.floor(window.innerHeight/2-v/2);if(r>738){var p=t.modal.dialog.find(".uk-modal-header").outerHeight(),x=t.modal.dialog.find(".image-footer").outerHeight(),k=t.modal.dialog.find(".uk-modal-footer").outerHeight();m+p+x+k+b>g&&(b=10,m=Math.floor(g)-p-x-k-3*b,c=Math.ceil(e.meta.width*(m/e.meta.height)))}else b=10;if("iframe"==e.type){var w=this.modal.content.find("iframe:first").width(),y=this.modal.content.find("iframe:first").height();r>738?(w+f+40>r||y+p+x+k+b>g)&&(b=10,c=r-f-150,this.modal.content.find("iframe:first").height(m).width(c)):(b=10,c=r,this.modal.content.find("iframe:first").height(m).width(c))}this.modal.dialog.animate({width:c+f+40,height:m+a,top:b},l,"swing",function(){t.modal.loader.addClass("uk-hidden"),t.modal.content.css({width:c}).animate({opacity:1},function(){t.modal.closer.removeClass("uk-hidden")}),t.modal.dialog.find(".uk-modal-head").animate({opacity:1},function(){}),t.modal.data({mwidth:c,mheight:m})})},show_sibling:function(i){this.show(i)},next:function(){this.show(this.siblings[this.index+1]?this.index+1:0)},previous:function(){this.show(this.siblings[this.index-1]?this.index-1:this.siblings.length-1)}}),i.plugin("lightbox","image",{init:function(t){t.on("showitem.uk.lightbox",function(t,e){if("image"==e.type||e.source&&e.source.match(/\.(jpg|jpeg|png|gif|svg)$/i)){var o=function(i,t,a,o){e.meta={content:'<div data-active-sibling="'+e.index+'" class="uk-width-1-1 active_sibling">'+e.meta.hdr+'<img class="uk-padding-remove uk-align-center source " src ="'+i+'"><div data-active-sibling="'+e.index+'" class="uk-width-1-1 image-footer">'+e.date+"</div>"+e.meta.ftr+"</div>",related:'<div class="scrollbar"></div><div id="sub_grid" class="uk-width-1-1">'+t+"</div>",width:a,height:o},e.type="image",e.promise.resolve()};if(a[e.source])o(e.source,e.meta.related,a[e.source].width,a[e.source].height,e.meta.r_width,e.meta.r_height),i.$(".sibling").each(function(){$(this).data("sibling-index")==e.index&&$(this).addClass("sibling-highlight")});else{var d=new Image;d.onerror=function(){e.promise.reject("Loading image failed")},d.onload=function(){a[e.source]={width:d.width,height:d.height},o(e.source,e.meta.related,a[e.source].width,a[e.source].height),i.$(".sibling").each(function(){$(this).data("sibling-index")==e.index&&$(this).addClass("sibling-highlight")})},d.src=e.source}}})}}),i.plugin("lightbox","youtube",{init:function(t){var e=/(\/\/.*?youtube\.[a-z]+)\/watch\?v=([^&]+)&?(.*)/,o=/youtu\.be\/(.*)/;t.on("showitem.uk.lightbox",function(t,d){var s,n,h=function(i,t,e,a){d.meta={content:'<div data-active-sibling="'+d.index+'" class="uk-width-1-1 active_sibling">'+d.meta.hdr+'<iframe class="source" src="//www.youtube.com/embed/'+i+'" width="'+e+'" height="'+a+'" style="max-width:100%;"></iframe><div data-active-sibling="'+d.index+'" class="uk-width-1-1 image-footer">'+d.date+"</div>"+d.meta.ftr+"</div>",related:'<div class="scrollbar"></div><div id="sub_grid" class="uk-width-1-1">'+t+"</div>",width:e,height:a},d.type="iframe",d.promise.resolve()};if((n=d.source.match(e))&&(s=n[2]),(n=d.source.match(o))&&(s=n[1]),s){if(a[s])h(s,d.meta.related,a[s].width,a[s].height),i.$(".sibling").each(function(){$(this).data("sibling-index")==d.index&&$(this).addClass("sibling-highlight")});else{var l=new Image,r=!1;l.onerror=function(){a[s]={width:640,height:320},h(s,d.meta.related,a[s].width,a[s].height)},l.onload=function(){120==l.width&&90==l.height?r?(a[s]={width:640,height:320},h(s,d.meta.related,a[s].width,a[s].height)):(r=!0,l.src="//img.youtube.com/vi/"+s+"/0.jpg"):(a[s]={width:l.width,height:l.height},h(s,d.meta.related,l.width,l.height)),i.$(".sibling").each(function(){$(this).data("sibling-index")==d.index&&$(this).addClass("sibling-highlight")})},l.src="//img.youtube.com/vi/"+s+"/maxresdefault.jpg"}t.stopImmediatePropagation()}})}}),i.plugin("lightbox","vimeo",{init:function(t){var e,o=/(\/\/.*?)vimeo\.[a-z]+\/([0-9]+).*?/;t.on("showitem.uk.lightbox",function(t,d){var s,n=function(i,t,e,a){d.meta={content:'<div data-active-sibling="'+d.index+'" class="uk-width-1-1 active_sibling">'+d.meta.hdr+'<iframe class="source" src="//player.vimeo.com/video/'+i+'" width="'+e+'" height="'+a+'" style="width:100%;box-sizing:border-box;"></iframe><div data-active-sibling="'+d.index+'" class="uk-width-1-1 image-footer">'+d.date+"</div>"+d.meta.ftr+"</div>",related:'<div class="scrollbar"></div><div id="sub_grid" class="uk-width-1-1">'+t+"</div>",width:e,height:a},d.type="iframe",d.promise.resolve()};(e=d.source.match(o))&&(s=e[2],a[s]?(n(s,d.meta.related,a[s].width,a[s].height),i.$(".sibling").each(function(){$(this).data("sibling-index")==d.index&&$(this).addClass("sibling-highlight")})):i.$.ajax({type:"GET",url:"http://vimeo.com/api/oembed.json?url="+encodeURI(d.source),jsonp:"callback",dataType:"jsonp",success:function(t){a[s]={width:t.width,height:t.height},n(s,d.meta.related,a[s].width,a[s].height),i.$(".sibling").each(function(){$(this).data("sibling-index")==d.index&&$(this).addClass("sibling-highlight")})}}),t.stopImmediatePropagation())})}}),i.plugin("lightbox","video",{init:function(t){t.on("showitem.uk.lightbox",function(t,e){var o=function(i,t,a,o){e.meta={content:'<div data-active-sibling="'+e.index+'" class="uk-width-1-1 active_sibling">'+e.meta.hdr+'<video class="uk-responsive-width source" src="'+i+'" width="'+a+'" height="'+o+'" controls></video><div data-active-sibling="'+e.index+'" class="uk-width-1-1 image-footer">'+e.date+"</div>"+e.meta.ftr+"</div>",related:'<div class="scrollbar"></div><div id="sub_grid" class="uk-width-1-1">'+t+"</div>",width:a,height:o},e.type="video",e.promise.resolve()};if("video"==e.type||e.source.match(/\.(\bmp4\b|\bwebm\b|\bogv\b)$/i))if(a[e.source])o(e.source,e.meta.related,a[e.source].width,a[e.source].height),i.$(".sibling").each(function(){$(this).data("sibling-index")==e.index&&$(this).addClass("sibling-highlight")});else var d=i.$('<video style="position:fixed;visibility:hidden;top:-10000px;"></video>').attr("src",e.source).appendTo("body"),s=setInterval(function(){d[0].videoWidth&&(clearInterval(s),a[e.source]={width:d[0].videoWidth,height:d[0].videoHeight},o(e.source,e.meta.related,a[e.source].width,a[e.source].height),d.remove(),i.$(".sibling").each(function(){$(this).data("sibling-index")==e.index&&$(this).addClass("sibling-highlight")}))},20)})}}),i.lightbox.create=function(t,e){if(t){var a,o=[];return t.forEach(function(t){o.push(i.$.extend({source:"",type:"auto",link:!1},"string"==typeof t?{source:t}:t))}),a=i.lightbox(i.$.extend({},e,{group:o}))}},i.lightbox});